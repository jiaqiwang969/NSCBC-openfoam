function [M_0,M_1,M_2,A_x,A_y,A_z,m_layer]=pem_layer_uwus(rho_f,rho,M,H,Psi,Ma)



%% Porous layer

m_layer=4;

M_0=zeros(13,13);
M_0(7,13) = 1;
M_0(8,3) = -1;
M_0(9,4) = -1;
M_0(10,12) = -1;
M_0(11,11) = -1;
M_0(12,10) = -1;
M_0(13,5) = -1;

% terms on (jw)
M_1=zeros(13,13);

% terms on (-w^2)

M_2=zeros(13,13);
M_2(1:2,1:2) = rho_f*eye(2);
M_2(3,9) = rho_f;
M_2(1:3,6:8) = rho*eye(3);

M_2(4:6,6:8) = rho_f*eye(3);
M_2(4:6,1:2) = Psi(1:3,1:2);
M_2(4:6,9) = Psi(1:3,3);

% terms on (-jk_x)
A_x=zeros(13,13);
A_x(1,3) = 1;
A_x(2,5) = 1;
A_x(3,10) = 1;
A_x(4,13) = -1;
A_x(7,1) = M;
A_x(7,6) = Ma(1);
A_x(7,7) = Ma(6);
A_x(7,8) = Ma(5);
A_x(8:13,1) = Ma;

A_x(8:13,6) = H(:,1);
A_x(8:13,7) = H(:,6);
A_x(8:13,8) = H(:,5);

% terms on (-jk_y)
A_y=zeros(13,13);
A_y(1,5) = 1;
A_y(2,4) = 1;
A_y(3,11) = 1;
A_y(5,13) = -1;
A_y(7,2) = M;
A_y(7,6) = Ma(6);
A_y(7,7) = Ma(2);
A_y(7,8) = Ma(4);
A_y(8:13,2) = Ma;

A_y(8:13,6)=H(:,6);
A_y(8:13,7)=H(:,2);
A_y(8:13,8)=H(:,4);

% terms on (d/dz)
A_z=zeros(13,13);
A_z(1:3,10:12) = eye(3);
A_z(6,13) = -1;
A_z(7,9) = M;
A_z(7,6) = Ma(5);
A_z(7,7) = Ma(4);
A_z(7,8) = Ma(3);
A_z(8:13,9) = Ma;

A_z(8:13,6)=H(:,5);
A_z(8:13,7)=H(:,4);
A_z(8:13,8)=H(:,3);



